<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Kate‚Äôs Mood Companion ‚Äî Playlists</title>
  <meta name="description" content="Navy + violet interactive Spotify hub with a chill mood companion named Boris." />
  <style>
    :root{
      --bg1:#0a1330; /* deep navy */
      --bg2:#0d163a;
      --card: rgba(18, 24, 56, 0.55);
      --glass: rgba(255,255,255,0.06);
      --text:#e9e9f2;
      --muted:#aab0c8;
      --violet:#b38cff;
      --violet-strong:#c9a9ff;
      --border:#243059;
      --success:#77e0b5;
      --warning:#ffd37a;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color:var(--text);
      background: radial-gradient(1200px 800px at 10% -10%, #121a43 0%, transparent 60%),
                  radial-gradient(900px 600px at 100% 0%, #08102e 0%, transparent 55%),
                  linear-gradient(180deg,var(--bg1),var(--bg2));
      overflow-x:hidden;
    }
    /* Floating violet orbs */
    .orb{
      position:fixed; inset:auto; z-index:-1; pointer-events:none; filter:blur(60px); opacity:.35;
      width:280px; height:280px; border-radius:50%;
      background:radial-gradient(circle at 30% 30%, var(--violet-strong), #5a3b9d 70%, transparent 72%);
      animation: float 18s ease-in-out infinite;
    }
    .orb.o2{ width:360px; height:360px; left:-80px; bottom:-80px; animation-duration: 26s; opacity:.28 }
    .orb.o1{ right:-120px; top:-60px }
    @keyframes float{
      0%{ transform: translate(0,0) scale(1) rotate(0deg) }
      50%{ transform: translate(-20px,14px) scale(1.06) rotate(8deg) }
      100%{ transform: translate(0,0) scale(1) rotate(0deg) }
    }

    .wrap{max-width:1100px;margin:0 auto;padding:24px}
    header{
      display:grid;gap:12px;align-items:start;grid-template-columns:1fr auto;
      border-bottom:1px solid var(--border); padding-bottom:16px; margin-bottom:22px;
    }
    h1{font-size:clamp(1.6rem,2.5vw,2.2rem);margin:0;letter-spacing:.3px}
    .muted{color:var(--muted);font-size:.95rem}
    .pill{
      display:inline-flex;align-items:center;gap:8px;
      border:1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.03));
      padding:8px 12px;border-radius:999px;color:var(--text)
    }
    .btn{
      display:inline-flex;align-items:center;gap:8px;cursor:pointer;
      background:var(--violet);color:#0b0d12;border:0;border-radius:999px;padding:10px 14px;font-weight:700;
      box-shadow:0 10px 24px rgba(179,140,255,.25); transition: transform .12s ease, filter .12s ease, background .2s ease
    }
    .btn:hover{ transform: translateY(-1px); filter:brightness(1.05) }
    .btn.secondary{ background:transparent; color:var(--text); border:1px solid var(--border) }
    .btn.ghost{ background:transparent; border:1px dashed var(--border); color:var(--muted) }
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}

    .card{
      position:relative;
      background: linear-gradient(180deg, var(--glass), rgba(255,255,255,0.03));
      border:1px solid var(--border);
      border-radius:18px;padding:18px; box-shadow:0 8px 28px rgba(0,0,0,.35);
      backdrop-filter: blur(8px);
      transition: box-shadow .25s ease, transform .25s ease, border-color .25s ease;
    }
    .card:hover{ box-shadow:0 14px 36px rgba(0,0,0,.45) }
    .sec-title{font-size:1.08rem;margin:.25rem 0 .6rem;letter-spacing:.2px}
    .grid{display:grid;gap:18px}
    @media(min-width: 940px){ .grid{ grid-template-columns: 1.1fr .9fr } }

    .playlist{ transition: opacity .35s ease, transform .35s ease }
    .playlist.hidden{ opacity:0; transform: scale(.98); height:0; overflow:hidden; padding:0; margin:0; border:0 }

    footer{margin-top:28px;border-top:1px solid var(--border);padding-top:16px;color:var(--muted);font-size:.9rem;text-align:center}

    /* BORIS ‚Äî Mood Companion */
    .boris{ display:grid; gap:12px }
    .boris .head{ display:flex; align-items:center; gap:10px }
    .avatar{
      width:36px;height:36px;border-radius:50%;
      background: radial-gradient(circle at 30% 30%, var(--violet-strong), #5a3b9d 70%);
      border:1px solid var(--border);
      box-shadow: 0 0 22px rgba(179,140,255,.25);
    }
    .boris .msg{
      background: rgba(255,255,255,0.04);
      border:1px solid var(--border);
      border-radius:14px; padding:10px 12px;
      line-height:1.55;
    }
    .boris .typing:after{
      content:""; display:inline-block; width:1ch; text-align:left;
      animation: dots 1.1s infinite steps(3,end);
    }
    @keyframes dots{
      0%{content:"."} 33%{content:".."} 66%{content:"..."} 100%{content:"."}
    }
    .boris .controls{ display:flex; gap:8px; flex-wrap:wrap }
    .chip{
      border:1px solid var(--border); background:rgba(255,255,255,0.03); color:var(--text);
      padding:6px 10px; border-radius:999px; cursor:pointer; font-size:.95rem
    }
    .chip:hover{ border-color: var(--violet); color:var(--violet-strong) }
    .inputrow{ display:flex; gap:8px; flex-wrap:wrap }
    input[type="text"]{
      flex:1; min-width:200px; background: rgba(255,255,255,0.05); color:var(--text);
      border:1px solid var(--border); border-radius:999px; padding:10px 12px; outline:none;
    }
    input[type="text"]::placeholder{ color:#9aa2c6 }
    .note{ color:var(--muted); font-size:.9rem; margin-top:6px }

    /* Accent ring when active */
    .active-ring{
      box-shadow: 0 0 0 2px rgba(179,140,255,.45), 0 0 32px rgba(179,140,255,.25) inset;
      border-color: #3b2a6d;
    }
  </style>
</head>
<body>
  <!-- background orbs -->
  <div class="orb o1"></div>
  <div class="orb o2"></div>

  <div class="wrap">
    <header>
      <div>
        <div class="pill">Spotify ‚Ä¢ Navy + Violet</div>
        <h1>Kate‚Äôs Mood Companion</h1>
        <p class="muted">Boris recommends songs for your vibe. Click a mood, or hit ‚ÄúSurprise Me!‚Äù.</p>
      </div>
      <div class="row">
        <button class="btn" id="surprise">üéß Surprise Me!</button>
        <button class="btn secondary" id="ambientToggle" aria-pressed="false">üéµ Play Ambient</button>
      </div>
    </header>

    <!-- BORIS card -->
    <section class="card boris" id="borisCard" aria-label="Mood companion">
      <div class="head">
        <div class="avatar" aria-hidden="true"></div>
        <div>
          <div class="pill" style="padding:6px 10px">Boris</div>
          <div class="msg" id="borisMsg">Hey, I‚Äôm Boris. How are you feeling right now?</div>
        </div>
      </div>

      <div class="controls">
        <!-- Mood chips correspond to playlist IDs -->
        <button class="chip" data-mood="adult">üñ§ Adult</button>
        <button class="chip" data-mood="scream">üé§ Scream It Out</button>
        <button class="chip" data-mood="trip">üåí Trip Hop</button>
        <button class="chip" data-mood="dance">üíÉ Try to Dance</button>
      </div>

      <div class="inputrow">
        <input id="moodInput" type="text" placeholder="Type your mood‚Ä¶ e.g. calm, angry, hyped" />
        <button class="btn" id="recommend">Recommend a Song</button>
      </div>
      <div class="note">Tip: I‚Äôll remember your last vibe for next time.</div>
    </section>

    <main class="grid" id="playlistsArea">
      <!-- Order requested by user: 1 Adult, 2 Scream, 3 Trip, 4 Dance -->

      <!-- Adult -->
      <section class="card playlist active-ring" data-mood="adult" id="pl-adult" aria-label="Adult playlist">
        <h2 class="sec-title">üñ§ Adult</h2>
        <iframe style="border-radius:12px" src="https://open.spotify.com/embed/playlist/2CbHm5VdfaHtagaos0661C?utm_source=generator"
          width="100%" height="392" frameborder="0"
          allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
        <p class="note">Your original playlist. <a class="pill" href="https://open.spotify.com/playlist/2CbHm5VdfaHtagaos0661C?si=433d542934874c3a" target="_blank" rel="noopener">Open in Spotify</a></p>
      </section>

      <!-- Scream It Out -->
      <section class="card playlist" data-mood="scream" id="pl-scream" aria-label="Scream It Out playlist">
        <h2 class="sec-title">üé§ Scream It Out</h2>
        <iframe style="border-radius:12px" src="https://open.spotify.com/embed/playlist/34lbQNg41HLMflbRTBgWte?utm_source=generator"
          width="100%" height="392" frameborder="0"
          allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
      </section>

      <!-- Trip Hop -->
      <section class="card playlist" data-mood="trip" id="pl-trip" aria-label="Trip Hop playlist">
        <h2 class="sec-title">üåí Trip Hop</h2>
        <iframe style="border-radius:12px" src="https://open.spotify.com/embed/playlist/4aq8RdgIQa1enrSgTgLkFo?utm_source=generator"
          width="100%" height="392" frameborder="0"
          allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
      </section>

      <!-- Try to Dance -->
      <section class="card playlist" data-mood="dance" id="pl-dance" aria-label="Try to Dance playlist">
        <h2 class="sec-title">üíÉ Try to Dance</h2>
        <!-- TODO: If you have a different playlist link for 'Try to Dance', replace this with that link. -->
        <iframe style="border-radius:12px" src="https://open.spotify.com/embed/playlist/2CbHm5VdfaHtagaos0661C?utm_source=generator"
          width="100%" height="392" frameborder="0"
          allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
        <p class="note">Using your original playlist for now. Replace this embed with your dedicated ‚ÄúTry to Dance‚Äù playlist link anytime.</p>
      </section>

      <!-- About section -->
      <section class="card" aria-label="About">
        <h2 class="sec-title">About These Playlists</h2>
        <p>Dark navy nights and violet lights ‚Äî a mood machine for dancing, catharsis, and late-night haze. Boris listens, thinks, then hands you a track to match.</p>
      </section>
    </main>

    <section class="card" style="margin-top:18px" aria-label="Quick actions">
      <div class="row">
        <a class="pill" href="https://github.com/Overcomplikate/Playlist-showcase" target="_blank" rel="noopener">View Source on GitHub</a>
        <a class="pill" href="https://overcomplikate.github.io/Playlist-showcase/" target="_blank" rel="noopener">Open Live Site</a>
        <span class="pill">‚åò/Ctrl + D to bookmark</span>
      </div>
    </section>

    <footer>Made with ‚ô• by Kate ‚Äî with a little help from Boris.</footer>
  </div>

  <script>
    // ========= Ambient Audio (WebAudio, royalty-free synth) =========
    let audioCtx = null, masterGain = null, isAmbientOn = false, lfo = null, oscA=null, oscB=null, filt=null;
    const ambientBtn = document.getElementById('ambientToggle');
    function startAmbient(){
      if(isAmbientOn) return;
      if(!audioCtx){
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        masterGain = audioCtx.createGain();
        masterGain.gain.value = 0.08; // gentle
        masterGain.connect(audioCtx.destination);

        // Create a simple ambient pad: two detuned sines through a lowpass filter with LFO
        oscA = audioCtx.createOscillator();
        oscB = audioCtx.createOscillator();
        oscA.type = 'sine'; oscB.type='sine';
        oscA.frequency.value = 138; // A2-ish
        oscB.frequency.value = 276; // A3-ish
        oscB.detune.value = 6; // slight detune

        filt = audioCtx.createBiquadFilter();
        filt.type = 'lowpass';
        filt.frequency.value = 600;
        filt.Q.value = 0.6;

        lfo = audioCtx.createOscillator();
        const lfoGain = audioCtx.createGain();
        lfo.type='sine'; lfo.frequency.value = 0.12; // slow movement
        lfoGain.gain.value = 120; // mod depth for filter freq
        lfo.connect(lfoGain).connect(filt.frequency);

        const g = audioCtx.createGain();
        g.gain.value = 0.55;

        oscA.connect(g); oscB.connect(g);
        g.connect(filt).connect(masterGain);

        lfo.start();
        oscA.start(); oscB.start();
      }else if(audioCtx.state === 'suspended'){
        audioCtx.resume();
      }
      isAmbientOn = true;
      ambientBtn.textContent = 'üîá Stop Ambient';
      ambientBtn.setAttribute('aria-pressed','true');
    }
    function stopAmbient(){
      if(!audioCtx) return;
      audioCtx.suspend();
      isAmbientOn = false;
      ambientBtn.textContent = 'üéµ Play Ambient';
      ambientBtn.setAttribute('aria-pressed','false');
    }
    ambientBtn.addEventListener('click', ()=>{
      if(!isAmbientOn){ startAmbient(); } else { stopAmbient(); }
    });

    // ========= Playlists + Mood Logic =========
    const playlists = document.querySelectorAll('.playlist');
    const borisMsg = document.getElementById('borisMsg');
    const moodChips = document.querySelectorAll('.chip');
    const moodInput = document.getElementById('moodInput');
    const recommendBtn = document.getElementById('recommend');
    const surpriseBtn = document.getElementById('surprise');

    // Song pools from Kate
    const songs = {
      dance: [
        {t:"Lola's Theme", a:"The Shapeshifters"},
        {t:"Walking Away", a:"The Egg"},
        {t:"Encore Une Fois (Future Breeze Edit)", a:"Sash!"}
      ],
      scream: [
        {t:"Everybody's Fool", a:"Evanescence"},
        {t:"What I've Done", a:"Linkin Park"},
        {t:"Dark Necessities", a:"Red Hot Chili Peppers"}
      ],
      trip: [
        {t:"Glory Box", a:"Portishead"},
        {t:"6 Underground", a:"Sneaker Pimps"},
        {t:"Hell Is Round the Corner", a:"Tricky"}
      ],
      adult: [
        // You can curate a separate 'Adult' set here if you like, otherwise we'll pick across moods:
        {t:"Glory Box", a:"Portishead"},
        {t:"What I've Done", a:"Linkin Park"},
        {t:"Lola's Theme", a:"The Shapeshifters"}
      ]
    };

    const moodKeywords = {
      scream: ["angry","rage","scream","frustrated","loud","heavy","mad"],
      trip:   ["calm","moody","late","night","smoky","hazy","float","down"],
      dance:  ["dance","happy","hyped","energy","party","move","groove","vibe"],
      adult:  ["adult","mix","default","classic","all","main"]
    };

    function moodFromText(txt){
      const t = (txt||"").toLowerCase();
      // Quick keyword scan
      for(const mood of Object.keys(moodKeywords)){
        if(moodKeywords[mood].some(k=>t.includes(k))) return mood;
      }
      // fallbacks
      if(t.includes("sad")||t.includes("blue")) return "trip";
      if(t.includes("tired")||t.includes("meh")) return "dance";
      return "adult"; // default
    }

    function showMood(mood){
      playlists.forEach(pl=>{
        pl.classList.add('hidden');
        pl.classList.remove('active-ring');
      });
      const target = document.querySelector(`.playlist[data-mood="${mood}"]`);
      if(target){
        target.classList.remove('hidden');
        target.classList.add('active-ring');
        // scroll into view smoothly
        setTimeout(()=>target.scrollIntoView({behavior:'smooth', block:'start'}), 60);
      }
      localStorage.setItem('lastMood', mood);
    }

    function typeReply(text, delay=38){
      borisMsg.textContent = ""; // clear
      const span = document.createElement('span');
      span.className = "typing";
      span.textContent = "Thinking";
      borisMsg.appendChild(span);
      // fake thinking period
      setTimeout(()=>{
        borisMsg.classList.remove('typing');
        borisMsg.textContent = "";
        let i=0;
        (function next(){
          borisMsg.textContent = text.slice(0, i++);
          if(i <= text.length) requestAnimationFrame(next);
        })();
      }, 700);
    }

    function pickSong(mood){
      const pool = songs[mood] && songs[mood].length ? songs[mood] : [...songs.dance, ...songs.scream, ...songs.trip];
      return pool[Math.floor(Math.random()*pool.length)];
    }

    function spotifySearchURL(title, artist){
      const q = encodeURIComponent(`${title} ${artist}`);
      return `https://open.spotify.com/search/${q}`;
    }

    function recommendForMood(mood){
      const s = pickSong(mood);
      const url = spotifySearchURL(s.t, s.a);
      const messageByMood = {
        adult:  `Mmm‚Ä¶ keeping it classic. Try ‚Äú${s.t}‚Äù ‚Äî ${s.a}.`,
        scream: `Feels cathartic. ‚Äú${s.t}‚Äù by ${s.a} should help you let it out.`,
        trip:   `Soft focus and shadowed corners‚Ä¶ ‚Äú${s.t}‚Äù ‚Äî ${s.a}.`,
        dance:  `Let‚Äôs move. ‚Äú${s.t}‚Äù by ${s.a} belongs on right now.`
      };
      typeReply(`${messageByMood[mood]}  `);
      // Append link after typing finishes
      setTimeout(()=>{
        const a = document.createElement('a');
        a.href = url; a.target = "_blank"; a.rel="noopener";
        a.textContent = "Open on Spotify";
        a.className = "pill";
        borisMsg.appendChild(document.createTextNode(" "));
        borisMsg.appendChild(a);
      }, 1400);
    }

    // Chip clicks
    moodChips.forEach(chip=>chip.addEventListener('click', ()=>{
      const mood = chip.dataset.mood;
      showMood(mood);
      recommendForMood(mood);
    }));

    // Text input
    recommendBtn.addEventListener('click', ()=>{
      const mood = moodFromText(moodInput.value);
      showMood(mood);
      recommendForMood(mood);
    });

    // Surprise Me
    surpriseBtn.addEventListener('click', ()=>{
      const keys = ["adult","scream","trip","dance"];
      const mood = keys[Math.floor(Math.random()*keys.length)];
      showMood(mood);
      typeReply("Feeling spontaneous? I‚Äôve got something for that‚Ä¶");
      setTimeout(()=>recommendForMood(mood), 900);
    });

    // Restore last mood
    const last = localStorage.getItem('lastMood') || "adult";
    if(last !== "adult"){
      // hide adult, show last
      document.querySelector('.playlist[data-mood="adult"]').classList.add('hidden');
      showMood(last);
    } else {
      // Ensure others are hidden initially
      ["scream","trip","dance"].forEach(m=>{
        const el = document.querySelector(`.playlist[data-mood="${m}"]`);
        if(el) el.classList.add('hidden');
      });
    }
  </script>
</body>
</html>
